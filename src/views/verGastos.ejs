<!-- verGastos.ejs -->
<!DOCTYPE html>
<html lang="es">
<head>
  <%- include('./partials/head') %>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    /* Estilos personalizados para el formulario */
    .container {
      max-width: 600px; /* Ajusta el ancho máximo del formulario según tus necesidades */
    }

    .form-group {
      margin-bottom: 1.5rem; /* Espaciado inferior entre grupos de formulario */
    }

    .form-select,
    .form-control {
      background-color: #ffffff; /* Cambia el color de fondo a blanco */
    }

    /* Estilos para el botón de submit */
    button[type="submit"] {
      background-color: #007bff; /* Color de fondo del botón */
      color: #ffffff; /* Color del texto del botón */
    }

  </style>
</head>
<body class="mt-4">
  <%- include('./partials/header') %>

  <!-- Contenido de la página -->
  <div class="container-fluid p-0">
    <div class="container">

        <h2>Gastos</h2>
    
        <!-- Formulario para seleccionar año y mes -->
        <form method="GET" action="/ver/gastos">
          <div class="form-group">
            <label for="year">Año:</label>
            <select class="form-select" name="year" id="year">
              <% const yearActual = new Date().getFullYear(); %>
              <% for (let i = 2030; i >= 2000; i--) { %>
                <option value="<%= i %>" <% if (i == userYear) { %>selected<% } %>><%= i %></option>
              <% } %>
            </select>
          </div>
    
          <div class="form-group">
            <label for="month">Mes:</label>
            <select class="form-select" name="month" id="month">
              <% const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre']; %>
              <% for (let i = 1; i <= meses.length; i++) { %>
                <option value="<%= i %>" <% if (i == userMonth) { %>selected<% } %>><%= meses[i - 1] %></option>
              <% } %>
            </select>
          </div>
    
          <button type="submit" class="btn btn-primary fs-4 ">Filtrar</button>
        </form>
    </div>

    <!-- Tabla de gastos -->
    <table class="table table-striped table-primary mt-4 mb-4 fs-3">
      <thead>
        <tr>          
          <th>Tipo de Gasto</th>
          <th>Precio</th>
          <th>Año</th>
          <th>Mes</th>
          <th>Departamento</th>
        </tr>
      </thead>
      <tbody>
        <% let totalGastos = 0; %>
        <% gastos.forEach(gasto => { %>
          <tr>            
            <td><%= gasto.tipoGasto %></td>
            <td><strong>$<%= parseInt(gasto.precio).toLocaleString() %></strong></td>
            <td><%= gasto.year %></td>
            <td><%= meses[gasto.month - 1].toLocaleString() %></td>
            <td><%= gasto.departamento.toLocaleString() %></td>
            <% totalGastos += parseInt(gasto.precio); %>
          </tr>
        <% }); %>
      </tbody>
    </table>

    <!-- Información adicional -->
   
      <div class="text-center mt-4">
        <p class="fs-2"><strong>Total</strong> de gastos para <strong><%= meses[userMonth - 1] %></strong> por departamento: <strong>$<%= totalGastos.toLocaleString() %></strong></p>
        <p class="fs-2"><strong>Total</strong> dividido por 2: <strong>$<%= (totalGastos / 2).toLocaleString() %></strong></p>
      </div>
    

  </div>

  <!-- Incluye el JS de Bootstrap y Popper.js (si es necesario) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Scripts de Bootstrap y cualquier otro script necesario -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
